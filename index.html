<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Filter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background-color: #000;
            color: #fff;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .selected-word {
            font-size: 48px;
            text-align: center;
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .numpad-container {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 15px;
            width: 300px;
        }

        .numpad-display {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 24px;
            margin-bottom: 15px;
            border-radius: 8px;
            min-height: 30px;
        }

        .numpad-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .numpad-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 15px;
            font-size: 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        .filtered-words {
            display: none;
            position: fixed;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 15px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .word-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .word {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            border: none;
            color: white;
            font-family: inherit;
            font-size: inherit;
        }

        .lexicon-letters {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .lexicon-letter {
            background: rgba(255, 184, 0, 0.2);
            color: #FFB800;
            border: 1px solid #FFB800;
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="selected-word"></div>
    <div class="numpad-container">
        <div class="numpad-display"></div>
        <div class="numpad-grid">
            <button class="numpad-btn">1</button>
            <button class="numpad-btn">2</button>
            <button class="numpad-btn">3</button>
            <button class="numpad-btn">4</button>
            <button class="numpad-btn">5</button>
            <button class="numpad-btn">6</button>
            <button class="numpad-btn">7</button>
            <button class="numpad-btn">8</button>
            <button class="numpad-btn">9</button>
            <button class="numpad-btn backspace">‚Üê</button>
            <button class="numpad-btn">0</button>
            <button class="numpad-btn" style="visibility: hidden;"></button>
        </div>
    </div>
    <div class="filtered-words"></div>

    <script>
        // Initialize variables
        let currentCode = '';
        const numpadDisplay = document.querySelector('.numpad-display');
        const numpadContainer = document.querySelector('.numpad-container');
        const filteredWordsContainer = document.querySelector('.filtered-words');
        const selectedWordDisplay = document.querySelector('.selected-word');
        let wordList = [];

        // Load word list
        fetch('data/Long_Nouns.txt')
            .then(response => response.text())
            .then(text => {
                wordList = text.split('\n')
                    .map(word => word.trim())
                    .filter(word => word.length > 0);
            })
            .catch(error => console.error('Error loading word list:', error));

        // Add click handlers to numpad buttons
        document.querySelectorAll('.numpad-btn').forEach(button => {
            button.addEventListener('click', () => {
                if (button.classList.contains('backspace')) {
                    currentCode = currentCode.slice(0, -1);
                } else if (currentCode.length < 4 && button.textContent) {
                    currentCode += button.textContent;
                }
                
                numpadDisplay.textContent = currentCode;

                if (currentCode.length === 4) {
                    setTimeout(() => {
                        numpadContainer.style.display = 'none';
                        filterWords(currentCode);
                    }, 500);
                }
            });
        });

        // Letter shape categories
        const letterShapes = {
            straight: ['A', 'E', 'F', 'H', 'I', 'K', 'L', 'M', 'N', 'T', 'V', 'W', 'X', 'Y', 'Z'],
            mixed: ['B', 'D', 'G', 'J', 'P', 'Q', 'R', 'U', 'W', 'Y'],
            curved: ['C', 'G', 'J', 'O', 'Q', 'S', 'U', 'W']
        };

        function getLetterShape(letter) {
            letter = letter.toUpperCase();
            if (letterShapes.straight.includes(letter)) return 1;
            if (letterShapes.mixed.includes(letter)) return 2;
            if (letterShapes.curved.includes(letter)) return 3;
            return 0;
        }

        function getVowelPositions(word) {
            const vowels = ['A', 'E', 'I', 'O', 'U'];
            return [...word.toUpperCase()].map((letter, i) => 
                vowels.includes(letter) ? i + 1 : null
            ).filter(pos => pos !== null);
        }

        function filterWords(code) {
            const [length, firstVowel, secondVowel, shape] = code.split('').map(Number);
            
            const filteredWords = wordList.filter(word => {
                if (word.length !== length) return false;
                
                const vowelPositions = getVowelPositions(word);
                if (vowelPositions[0] !== firstVowel) return false;
                if (secondVowel > 0 && (!vowelPositions[1] || vowelPositions[1] !== secondVowel)) return false;
                
                return getLetterShape(word[0]) === shape;
            });

            displayFilteredWords(filteredWords);
        }

        function displayFilteredWords(words) {
            filteredWordsContainer.innerHTML = `
                <div class="word-list">
                    ${words.map(word => 
                        `<button class="word">${word}</button>`
                    ).join('')}
                </div>
            `;

            document.querySelectorAll('.word').forEach(button => {
                button.addEventListener('click', () => {
                    const word = button.textContent;
                    const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(word.toLowerCase())}&tbm=isch`;
                    
                    // First, remove the current page from history
                    history.replaceState(null, '', 'about:blank');
                    
                    // Then redirect to Google Images
                    window.location = searchUrl;
                });
            });

            filteredWordsContainer.style.display = 'block';
        }
    </script>
</body>
</html>
